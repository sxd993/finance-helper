## Инструкция для ИИ‑агента

Цель: быстро понять архитектуру проекта и писать код, который безболезненно встраивается в существующую систему.

### 1. Общие правила
- Архитектуру не меняем. Frontend построен на Feature‑Sliced Design (`app`, `entities`, `features`, `widgets`, `shared`, `pages`). Backend — Express + Sequelize с папками для маршрутов, моделей и вспомогательных модулей.
- Везде используем ES Modules. На фронте пишем только на TypeScript. Не смешиваем CommonJS и TS/ESM синтаксис.
- Именование: страницы `*Page.tsx`, виджеты `*Widget.tsx`, фичи `feature-name/action.ts`.

### 2. Backend
- Модели: `backend/src/models`. После создания подключи их в `backend/src/db/index.js` и опиши связи через `associate`.
- Бизнес-логика: отдельные файлы в `backend/src/features/<domain>` или `backend/src/routes/<domain>/utils`.
- Сложные операции над несколькими таблицами оборачивай в `sequelize.transaction`.
- Роуты регистрируй через `backend/src/app.js`. Для домена создавай собственный под-роутер (`/api/<domain>`).
- Планировщики/фоновые задачи держим в `backend/src/features`, запуск из `backend/src/server.js`.

### 3. Frontend
- Сразу определяй слой:
  - данные/типы → `entities`
  - бизнес-процессы и API → `features`
  - композиции UI → `widgets`
  - готовые страницы → `pages`
- UI-компоненты отвечают только за отображение. Вся бизнес-логика уходит в кастомные хуки/сервисы. Пропсы — только очень редки (например при .map).
- Используй провайдеры `app/providers` и alias `@/...`.
- Константы, типы, утилиты кладём в соответствующие FSD-папки, не прячем внутрь компонентов.
- Глобальное состояние — Redux Toolkit (`StoreProvider`). Локальное — React state. Сетевые запросы и кеширование выполняем через TanStack Query (`useQuery`/`useMutation`) поверх клиента `shared/api/client.tsx`.
- UI-библиотеки: Mantine + Tailwind. Все повторно используемые элементы складываем в `shared/ui`, не дублируем стили.

### 4. Тесты и качество
- Проверяй типы и контракты каждого нового API на обеих сторонах.
- Сложные решения документируй: короткий комментарий в коде или README в соответствующей папке.

### 5. Расширения
- Добавил API — опиши в `README.md` своего пакета: назначение, входные/выходные данные, пример вызова.
- DTO и форматы данных должны совпадать между фронтом и бэком. Общие константы/форматтеры живут в shared-слоях.
- Перед созданием новой утилиты поищи существующую (`shared/utils/formatPrice`, `backend/src/utils/dates` и т.п.) и переиспользуй.
